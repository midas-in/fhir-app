"use strict";(self.webpackChunkfhircore=self.webpackChunkfhircore||[]).push([[9930],{7878:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var t=o(5893),i=o(1151);const a={},r="CQL use cases",s={id:"engineering/writing-fhir/cql/sample-usage",title:"CQL use cases",description:"Use Case 1: G6PD Threshold management",source:"@site/docs/engineering/writing-fhir/cql/sample-usage.mdx",sourceDirName:"engineering/writing-fhir/cql",slug:"/engineering/writing-fhir/cql/sample-usage",permalink:"/engineering/writing-fhir/cql/sample-usage",draft:!1,unlisted:!1,editUrl:"https://github.com/opensrp/fhircore/tree/main/docs/engineering/writing-fhir/cql/sample-usage.mdx",tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Converting CQL to a library",permalink:"/engineering/writing-fhir/cql/convert-cql-to-library"},next:{title:"FHIRPath expressions",permalink:"/engineering/writing-fhir/fhir_path"}},l={},d=[{value:"Use Case 1: G6PD Threshold management",id:"use-case-1-g6pd-threshold-management",level:2},{value:"Additional context",id:"additional-context",level:3},{value:"Sample G6PD threshold evaluation CQL",id:"sample-g6pd-threshold-evaluation-cql",level:3},{value:"MedicationRequest Output from above CQL evaluation",id:"medicationrequest-output-from-above-cql-evaluation",level:3},{value:"G6PD Test Device Calibration",id:"g6pd-test-device-calibration",level:2},{value:"User Journey Description",id:"user-journey-description",level:3},{value:"Sample G6PD RDT Calibration (Control mode) CQL",id:"sample-g6pd-rdt-calibration-control-mode-cql",level:3},{value:"In app reporting of Indicators",id:"in-app-reporting-of-indicators",level:2},{value:"Using Measure Reporting to define Indicators",id:"using-measure-reporting-to-define-indicators",level:3},{value:"Family Group",id:"family-group",level:4},{value:"Measure Reporting CQL Expression",id:"measure-reporting-cql-expression",level:4},{value:"Measure Report Generated",id:"measure-report-generated",level:4}];function c(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"cql-use-cases",children:"CQL use cases"}),"\n",(0,t.jsx)(e.h2,{id:"use-case-1-g6pd-threshold-management",children:"Use Case 1: G6PD Threshold management"}),"\n",(0,t.jsx)(e.p,{children:"Plasmodium (P.) vivax is the most common species of malaria in countries close to eliminating the disease. The two commercially available drugs that can cure P. vivax are contraindicated for individuals with low levels of an enzyme called glucose-6-phosphate dehydrogenase (G6PD). G6PD deficiency is a genetic condition shared by 400 million people globally. Patients with G6PD deficiency are at risk of severe hemolysis upon exposure to tafenoquine or high primaquine doses required for cure of P. vivax malaria. PATH and our partners have advanced a point-of-care diagnostic device to measure G6PD activity. This test device, known as the STANDARD\u2122 G6PD Test, is manufactured by SD Biosensor (South Korea) and is now commercially available in several malaria-endemic countries. This product could be enhanced through digital connectivity to improve its use and workflow including patient data management, accurate results interpretation, quality control, and patient referral and monitoring."}),"\n",(0,t.jsx)(e.p,{children:"We developed a digital solution to successfully transfer and interpret data from the STANDARD G6PD Test device into a digital solution. Successful data transfer and interpretation is defined as user-friendly, accurate, and comprehensive. The digital solution will improve the test\u2019s use and workflow and support clinical case management of malaria."}),"\n",(0,t.jsx)(e.p,{children:"We implemented the following workflows for G6PD"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Manual based input approach : The first workflow entails using a\nFHIR questionnaire and extracting it to multiple FHIR resources\n(Patient, Practitioner, Location, Observation, ServiceRequest,\nDiagnostic report)."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"CQL Workflow : The second workflow supports the full request,\nevaluation, and response workflow using FHIR standards. This\nworkflow provides native FHIR support on the Android device where\navailable. The FHIR workflow will utilize the ServiceRequest and\nDiagnosticReport resources, as well as Clinical Quality Language\n(CQL) evaluation."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"The following feature and modules were implemented"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Authentication & Authorization"}),"\n",(0,t.jsx)(e.li,{children:"Patient Registration"}),"\n",(0,t.jsx)(e.li,{children:"Patient Search"}),"\n",(0,t.jsx)(e.li,{children:"Offline Support"}),"\n",(0,t.jsx)(e.li,{children:"Multi-language support"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"additional-context",children:"Additional context"}),"\n",(0,t.jsx)(e.p,{children:"For patient Diagnosis we used the following table to map the threshold evaluation"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://user-images.githubusercontent.com/69383347/149340339-10a723d2-707f-4ef8-b18e-ffc638c21ed7.png",alt:"456"})}),"\n",(0,t.jsx)(e.p,{children:"Post evaluation you get a results page with diagnosis and  Medication regimen recommendation"}),"\n",(0,t.jsx)("img",{width:"200",height:"400",src:"https://user-images.githubusercontent.com/4829880/150296890-9ee0ef91-3158-4c90-8b4d-10a83e2f3f1d.jpg"}),"\n",(0,t.jsx)("img",{width:"200",height:"400",src:"https://user-images.githubusercontent.com/4829880/150296898-cfa97ad8-eee4-4cb2-9552-46f67b9765b2.jpg"}),"\n",(0,t.jsx)("img",{width:"200",height:"400",src:"https://user-images.githubusercontent.com/4829880/150296901-ebc17aa2-b8d4-4695-88a1-d6ec8e6d7ab9.jpg"}),"\n",(0,t.jsx)(e.h3,{id:"sample-g6pd-threshold-evaluation-cql",children:"Sample G6PD threshold evaluation CQL"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'//Declare name and version of lib\nlibrary TestArtifact version \'1\'\n\n//FHIR as a data model and version of FHIR\nusing FHIR version \'4.0.1\'\n\n//functions to help FHIR vs CQL primitives\ninclude "FHIRHelpers" version \'4.0.1\' called FHIRHelpers\n\n//System declarations  : Codable concept codes systems\ncodesystem "SNOMED": \'http://snomed.info/sct\'\ncodesystem "ConditionClinicalStatusCodes": \'http://terminology.hl7.org/CodeSystem/condition-clinical\'\ncodesystem "ConditionVerificationStatusCodes": \'http://hl7.org/fhir/ValueSet/condition-ver-status\'\ncodesystem "ServiceReqCategoryCodes": \'http://hl7.org/fhir/ValueSet/servicerequest-category\'\ncodesystem "DiagReportCategoryCodes": \'http://hl7.org/fhir/ValueSet/diagnostic-service-sections\'\n\n//Code used as identifers\ncode "Pregnancy code": \'77386006\' from "SNOMED" display \'Pregnant\'\ncode "G6PD code": \'86859003\' from "SNOMED" display \'G6PD Enzyme\'\ncode "Haemoglobin code": \'259695003\' from "SNOMED" display \'Haemoglobin\'\ncode "active": \'active\' from "ConditionClinicalStatusCodes"\ncode "confirmed": \'confirmed\' from "ConditionVerificationStatusCodes"\ncode "g6pdStatusCode": \'9024005\' from "SNOMED" display \'G6PD Status\'\ncode "normalResultCode": \'280413001\' from "SNOMED" display \'Normal\'\ncode "deficientResultCode": \'260372006\' from "SNOMED" display \'Deficient\'\ncode "intermediateResultCode": \'11896004\' from "SNOMED" display \'Intermediate\'\ncode "serviceReqCategory": \'108252007\' from "ServiceReqCategoryCodes" display \'Laboratory procedure\'\ncode "diagReportCategory": \'HM\' from "DiagReportCategoryCodes" display \'Hematology\'\n\n//CQL is written from a perspective of a single patient\n//can be  run in a context for a Single patient or population\ncontext Patient\n\n// TODO see if we need to do any more filtering and sorting; rightnow only one encounter is passed\ndefine "Encounter":\n  Last([Encounter] E\n    where E.status ~ \'finished\' )\n\ndefine "AgeRange":\n  AgeInYears() >= 16\n\ndefine "Female":\n  Patient.gender = \'female\'\n\ndefine "Male":\n  Patient.gender = \'male\'\n\ndefine "is Pregnant":\n  Last([Condition: "Pregnancy code"] O\n    where O.clinicalStatus ~ "active"\n      sort by recordedDate) is not null\n\ndefine "Registerd Haem":\n  Last([Observation: "Haemoglobin code"] H\n    where H.status ~ \'registered\')\n\ndefine "Registerd G6PD":\n  Last([Observation: "G6PD code"] G\n    where G.status ~ \'registered\')\n\ndefine "Hi G6PD":\n  Last([Observation: "G6PD code"] H\n    where H.value.value > 20.0\n        return  true)\n\ndefine "Abnormal Haemoglobin":\n  Last([Observation: "Haemoglobin code"] H\n    where  H.value.value <= 8.0\n        return  true)\n\ndefine "NA Lo G6PD":\n  Last([Observation: "Haemoglobin code"] H\n    where  H.value.value < 4.0\n        return  true)\n\ndefine "NA Hi G6PD":\n  Last([Observation: "Haemoglobin code"] H\n    where H.value.value > 25.0\n        return  true)\n\n//Define Thresholds\ndefine "Deficient":\n  Last([Observation: "G6PD code"] G\n    where G.value.value <= 3.9\n        return true)\n\ndefine "Intermediate":\n  Last([Observation: "G6PD code"] G\n    where "Female" and G.value.value >= 4.1  and G.value.value <= 6.0\n      return  true)\n\ndefine "Normal Male":\n    Last([Observation: "G6PD code"] G\n        where "Male" and G.value.value >= 4.1\n            return  true)\n\ndefine "Normal Female":\n    Last([Observation: "G6PD code"] G\n        where "Female" and G.value.value >= 6.1\n            return  true)\n\ndefine "g6pdTestResultCode":\n      if "Deficient" then "deficientResultCode"\n      else if "Intermediate" then "intermediateResultCode"\n      else if "Normal Male" or "Normal Female" then "normalResultCode"\n      else null\n\ndefine "patientRef": ReplaceMatches(\'Patient/\'+Patient.id,\'#\',\'\')\ndefine "encounterRef": ReplaceMatches(\'Encounter/\'+Encounter.id,\'#\',\'\')\n\ndefine "condition": if "g6pdTestResultCode" is not null\n    then Condition {\n      subject: Reference {reference: string { value: "patientRef" } },\n      encounter: Reference {reference: string { value: "encounterRef" } },\n      clinicalStatus: CodeableConcept { coding: {\n        Coding {\n          code: code {value: "active".code },\n          system: uri {value: "active".system }\n        }\n      } },\n      verificationStatus: CodeableConcept { coding: {\n        Coding {\n          code: code {value: "confirmed".code },\n          system: uri {value: "confirmed".system }\n        }\n      } },\n      category: { CodeableConcept { coding: {\n        Coding {\n          code: code {value: "g6pdStatusCode".code },\n          system: uri {value: "g6pdStatusCode".system },\n          display: string {value: "g6pdStatusCode".display }\n        }\n      } } },\n      code: CodeableConcept { coding: {\n        Coding {\n          code: code {value: "g6pdTestResultCode".code },\n          system: uri {value: "g6pdTestResultCode".system },\n          display: string {value: "g6pdTestResultCode".display }\n        }\n      } },\n      onset: dateTime{ value: Today() },\n      recordedDate: dateTime{ value: Today() }\n    } else null\n\ndefine "serviceRequest": if "g6pdTestResultCode" is not null\n   then ServiceRequest{\n\t  subject: Reference {reference: string { value: "patientRef" } },\n      encounter: Reference {reference: string { value: "encounterRef" } },\n      status: ServiceRequestStatus { value: \'completed\'},\n      intent: ServiceRequestIntent {value: \'order\' },\n      category: { CodeableConcept { coding: {\n        Coding {\n          code: code {value: "serviceReqCategory".code },\n          system: uri {value: "serviceReqCategory".system },\n          display: string {value: "serviceReqCategory".display }\n        }\n      } } },\n      code: CodeableConcept { coding: {\n        Coding {\n          code: code {value: "G6PD code".code },\n          system: uri {value: "G6PD code".system },\n          display: string {value: "G6PD code".display }\n        }\n      } },\n      authoredOn: dateTime{ value: Today() }\n} else null\n\ndefine "diagnosticReport": if "g6pdTestResultCode" is not null\n   then DiagnosticReport{\n\t  subject: Reference {reference: string { value: "patientRef" } },\n      encounter: Reference {reference: string { value: "encounterRef" } },\n      status: DiagnosticReportStatus { value: \'final\'},\n      category: { CodeableConcept { coding: {\n        Coding {\n          code: code {value: "diagReportCategory".code },\n          system: uri {value: "diagReportCategory".system },\n          display: string {value: "diagReportCategory".display }\n        }\n      } } },\n      code: CodeableConcept { coding: {\n        Coding {\n          code: code {value: "G6PD code".code },\n          system: uri {value: "G6PD code".system },\n          display: string {value: "G6PD code".display }\n        }\n      } },\n      effective: dateTime{ value: Today() }\n} else null\n\ndefine "OUTPUT": List { "condition", "serviceRequest", "diagnosticReport" }\n'})}),"\n",(0,t.jsx)(e.h3,{id:"medicationrequest-output-from-above-cql-evaluation",children:"MedicationRequest Output from above CQL evaluation"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'{\n  "resourceType": "MedicationRequest",\n  "status": "active",\n  "intent": "proposal",\n  "subject": {\n    "reference": "Patient/P1"\n  },\n  "encounter": {\n    "reference": "Encounter/E1"\n  },\n  "authoredOn": "#NOW",\n  "category": [\n    {\n      "coding": [\n        {\n          "system": "http://snomed.info/sct",\n          "code": "86859003",\n          "display": "Glucose-6-phosphatedehydrogenasedeficiencyanaemia"\n        }\n      ]\n    }\n  ],\n  "medicationCodeableConcept": {\n    "coding": [\n      {\n        "system": "http://snomed.info/sct",\n        "code": "429663004",\n        "display": "Primaquine(substance)"\n      }\n    ]\n  },\n  "dosageInstruction": [\n    {\n      "timing": {\n        "repeat": {\n          "frequency": 1,\n          "period": 8,\n          "periodUnit": "wk"\n        }\n      },\n      "route": {\n        "coding": [\n          {\n            "system": "http://snomed.info/sct",\n            "code": "26643006",\n            "display": "Oraluse"\n          }\n        ]\n      },\n      "doseAndRate": [\n        {\n          "type": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/dose-rate-type",\n                "code": "ordered",\n                "display": "Ordered"\n              }\n            ]\n          },\n          "doseQuantity": {\n            "value": 0.75,\n            "unit": "mg/kg",\n            "system": "http://unitsofmeasure.org"\n          }\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"g6pd-test-device-calibration",children:"G6PD Test Device Calibration"}),"\n",(0,t.jsx)(e.p,{children:"In the second use case, as a G6PD app user, I would like to check if the device is properly calibrated  in either Control Mode 1 or Control Mode 2"}),"\n",(0,t.jsx)(e.p,{children:"First we added  both UI/UX for control mode user journey and leverage current CQL evaluation that can allow us to reuse the current CQL implementation for G6PD evaluation."}),"\n",(0,t.jsx)(e.p,{children:"We then added a Questionnaire for test calibration that is independent of the Patient/Clinical workflow."}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Control mode  table"})}),"\n",(0,t.jsx)("img",{width:"634",alt:"Screen Shot 2022-01-13 at 10 19 06 PM",src:"https://user-images.githubusercontent.com/4540684/149395158-22a99428-dd1c-4904-a0f2-dd12ffc93945.png"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Test Kit in normal mode"})}),"\n",(0,t.jsx)("img",{width:"260",alt:"Screen Shot 2022-01-13 at 10 23 20 PM",src:"https://user-images.githubusercontent.com/4540684/149396047-9c0a51c3-ddd5-4e69-9809-2281396ddac6.png"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Test kit in control mode"})}),"\n",(0,t.jsx)("img",{width:"611",alt:"Screen Shot 2022-01-13 at 10 25 36 PM",src:"https://user-images.githubusercontent.com/4540684/149396063-5b5e8b8d-cf2c-421d-9dfa-e7d3b99a3ae5.png"}),"\n",(0,t.jsxs)(e.p,{children:["More details on testing and control mode can be found in ",(0,t.jsx)(e.a,{href:"https://www.finddx.org/wp-content/uploads/2020/09/STANDARD-G6PD-test_Training_Bangladesh-FIND-icddr-Menzies_FINAL_26Nov19.pdf",children:"this manual"}),"."]}),"\n",(0,t.jsx)(e.h3,{id:"user-journey-description",children:"User Journey Description"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Add a menu item to initiate the control mode test"}),"\n",(0,t.jsxs)(e.li,{children:["Add a Questionnaire to be able to conduct control mode, similar to the Test Questionnaire, an image of control mode and the 2 entry points for G6PD and Haemoglobin level. This should have the following fields","\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"Chip No\nDevice Serial number\nG6PD level\nHaemoglobin level"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:"Author and load a CQL Library evaluation for control mode evaluation"}),"\n",(0,t.jsx)(e.li,{children:"Initiate the control mode evaluation on press submit"}),"\n",(0,t.jsx)(e.li,{children:"Add a test result page for Control mode level 1 or control mode level 2"}),"\n",(0,t.jsx)(e.li,{children:"Terminate control mode flow once the user has calibrated the device"}),"\n"]}),"\n",(0,t.jsx)("img",{width:"200",height:"400",src:"https://user-images.githubusercontent.com/4829880/149816294-00760977-20c5-4cfd-83ac-5e2b79b30184.jpg"}),"\n",(0,t.jsx)("img",{width:"200",height:"400",src:"https://user-images.githubusercontent.com/4829880/149816315-6f7ebaa1-d7cd-445b-8622-54f52d51780a.jpg"}),"\n",(0,t.jsx)("img",{width:"200",height:"400",src:"https://user-images.githubusercontent.com/4829880/149816323-0afb2558-35a4-47fd-9da5-88cb668f0d14.jpg"}),"\n",(0,t.jsx)("img",{width:"200",height:"400",src:"https://user-images.githubusercontent.com/4829880/149816328-b2841f26-4560-4613-8fd0-cd1bfe707967.jpg"}),"\n",(0,t.jsx)(e.h3,{id:"sample-g6pd-rdt-calibration-control-mode-cql",children:"Sample G6PD RDT Calibration (Control mode) CQL"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'//Declare name and version of lib\nlibrary ControlTest version \'1\'\n\n//FHIR as a data model and version of FHIR\nusing FHIR version \'4.0.1\'\n\n//functions to help FHIR vs CQL primitives\ninclude "FHIRHelpers" version \'4.0.1\' called FHIRHelpers\n\n//System declarations  : Codable concept codes systems\ncodesystem "SNOMED": \'http://snomed.info/sct\'\n\n//Code used as identifers\ncode "g6pdControl1": \'410680006\' from "SNOMED" display \'Control-mode 1\'\ncode "g6pdControl2": \'405358009\' from "SNOMED" display \'Control-mode 2\'\n\ndefine "QR" : Last([QuestionnaireResponse] H)\n\ndefine "Control1Obs": "QR".item.where(linkId=\'result_type\').answer.value ~ "g6pdControl1"\n\ndefine "Control2Obs": "QR".item.where(linkId=\'result_type\').answer.value ~  "g6pdControl2"\n\ndefine "HaemoglobinObs": "QR".item.where(linkId=\'haemoglobin\').answer.first().value\n\ndefine "G6PDObs": "QR".item.where(linkId=\'g6pd\').answer.first().value\n\ndefine "G6PDTemp": decimal {value: "G6PDObs".value}\ndefine "G6PDValue": ToString("G6PDTemp")\ndefine "HaemoglobinTemp": decimal {value: "HaemoglobinObs".value}\ndefine "HaemoglobinValue": ToString("HaemoglobinTemp")\n\ndefine "G6PD Normal":\n    if "Control1Obs" is not null and "G6PDObs" between 0.0 and 3.0\n    \tthen true\n    else if "Control2Obs" is not null and "G6PDObs" between 6.0 and 10.0\n    \tthen true\n    else false\n\ndefine "G6PD Conclusion":\n    if "Control1Obs" is not null and "G6PD Normal"\n    \tthen \'Value (\'+ "G6PDValue"+\') is in Normal G6PD Range 0-3\'\n    else if "Control2Obs" is not null and "G6PD Normal"\n    \tthen \'Value (\'+ "G6PDValue"+\') is in Normal G6PD Range 6-12\'\n    else \'Value(\'+"G6PDValue"+\') is Non Deterministic G6PD result\'\n\ndefine "Haemoglobin Normal":\n    if "Control1Obs" is not null and "HaemoglobinObs" between 8.0 and 12.0\n    \tthen true\n    else if "Control2Obs" is not null and "HaemoglobinObs" between 13.0 and 17.0\n    \tthen true\n    else false\n\ndefine "Haemoglobin Conclusion":\n    if "Control1Obs" is not null and "Haemoglobin Normal"\n    \tthen \'Value (\'+ "HaemoglobinValue"+\') is in Normal Haemoglobin Range 8-12\'\n    else if "Control2Obs" is not null and "Haemoglobin Normal"\n    \tthen \'Value (\'+ "HaemoglobinValue"+\') is in Normal Haemoglobin Range 13-17\'\n    else \'Value(\'+"HaemoglobinValue"+\') is Non Deterministic Haemoglobin result\'\n\ndefine "Conclusion":\n  if "G6PD Normal" and "Haemoglobin Normal" then \'Correct result\'\n  else \'Invalid result\'\n\ndefine "Conclusion Details": \'\\nDetails:\\n\'+ "G6PD Conclusion" + \'\\n\' + "Haemoglobin Conclusion"\n\n\ndefine "OUTPUT": List { "Conclusion" , "Conclusion Details"}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"in-app-reporting-of-indicators",children:"In app reporting of Indicators"}),"\n",(0,t.jsxs)(e.p,{children:["Based on the ",(0,t.jsx)(e.a,{href:"http://build.fhir.org/ig/WorldHealthOrganization/smart-anc/",children:"WHO Implementation Guide (IG) for ANC"})," and the ",(0,t.jsx)(e.a,{href:"https://github.com/WorldHealthOrganization/smart-anc/tree/master/input/cql",children:"WHO SMART ANC Indicators"}),". These indicators are based on the Global ANC monitoring framework (25) and the WHO\u2013UNICEF guidance for RMNCAH programme managers on the analysis and use of health facility data (10). These indicators may be aggregated automatically from the digital tracking tool to populate a digital HMIS, such as DHIS2."]}),"\n",(0,t.jsx)(e.p,{children:"Indicator definitions are represented using the FHIR Measure resource (CPGMetric profile) and is available here These indicators are based on the Global ANC monitoring framework (25) and the WHO\u2013UNICEF guidance for RMNCAH programme managers on the analysis and use of health facility data (10). These indicators may be aggregated automatically from the digital tracking tool to populate a digital HMIS, such as DHIS2."}),"\n",(0,t.jsxs)(e.p,{children:["Indicator definitions are represented using the FHIR Measure Resource ",(0,t.jsx)(e.a,{href:"http://build.fhir.org/ig/WorldHealthOrganization/smart-anc/documentation.html#indicators",children:"CPGMetric profile"}),"."]}),"\n",(0,t.jsx)(e.h3,{id:"using-measure-reporting-to-define-indicators",children:"Using Measure Reporting to define Indicators"}),"\n",(0,t.jsx)(e.p,{children:"Below are Sample Measure Reporting CQL for aggregate counts for households."}),"\n",(0,t.jsx)(e.h4,{id:"family-group",children:"Family Group"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'{\n  "resourceType": "Group",\n  "id": "107759",\n  "meta": {\n    "versionId": "3",\n    "lastUpdated": "2022-04-14T13:54:41.656+00:00",\n    "source": "#2f77c0c4a5d11f1e"\n  },\n  "identifier": [ {\n    "use": "official",\n    "value": "7bb7fa82-59e4-4744-a6d2-96722afca23b"\n  }, {\n    "use": "secondary",\n    "value": "656766"\n  } ],\n  "active": true,\n  "type": "person",\n  "code": {\n    "coding": [ {\n      "system": "https://www.snomed.org",\n      "code": "35359004",\n      "display": "Family"\n    } ]\n  },\n  "name": "Kamwana Rao",\n  "managingEntity": {\n    "reference": "RelatedPerson/2e2c9d4e-b67f-4673-8e83-e3f576046296"\n  },\n  "member": [ {\n    "entity": {\n      "reference": "Patient/c535f2e6-a17a-4b2a-913e-30e8b42553d0",\n      "display": "Rao Kamwana"\n    },\n    "inactive": false\n  }, {\n    "entity": {\n      "reference": "Patient/d0612f01-01c3-467e-9fbc-4e6ebe8bf9e6",\n      "display": "Magarita Rao"\n    },\n    "inactive": false\n  } ]\n}\n'})}),"\n",(0,t.jsx)(e.h4,{id:"measure-reporting-cql-expression",children:"Measure Reporting CQL Expression"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'//Declare name and version of lib\nlibrary PQMedication version \'1\'\n\n//FHIR as a data model and version of FHIR\nusing FHIR version \'4.0.1\'\n\n//functions to help FHIR vs CQL primitives\ninclude "FHIRHelpers" version \'4.0.1\' called FHIRHelpers\n\ncontext Patient\n\ndefine "All Groups": [Group] G\ndefine "All Person Groups": "All Groups" G where G.type = \'person\'\ndefine "All Group Members": flatten("All Person Groups" G return (G.member M return M.entity))\n\ndefine "All Patients": [Patient] P\n    with "All Group Members" G\n        such that P.id = Split(G.reference, \'/\')[1]\n\ndefine "Males": "All Patients" M where M.gender=\'male\'\ndefine "Females": "All Patients" F where F.gender=\'female\'\n\ndefine "Age": CalculateAgeInYears(Patient.birthDate)\n\ndefine "Age Stratifier":\n  case\n    when "Age" < 1 then \'P0Y\'\n    when "Age" in Interval[1,5] then \'P1-5Y\'\n    when "Age" in Interval[6, 14] then \'P6-14Y\'\n    when "Age" in Interval[15, 49] then \'P15-49Y\'\n    when "Age" >= 50 then \'P50Y\'\n    else \'Unspecified\'\n  end\n'})}),"\n",(0,t.jsx)(e.h4,{id:"measure-report-generated",children:"Measure Report Generated"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'{\n  "resourceType": "MeasureReport",\n  "extension": [\n    {\n      "url": "http://hl7.org/fhir/5.0/StructureDefinition/extension-MeasureReport.population.description",\n      "valueString": "???????????"\n    }\n  ],\n  "status": "complete",\n  "type": "summary",\n  "measure": "Measure/group-measure",\n  "date": "2022-05-20T14:17:20+03:00",\n  "period": {\n    "start": "2019-01-01T00:00:00+03:00",\n    "end": "2022-12-31T23:59:59+03:00"\n  },\n  "improvementNotation": {\n    "coding": [\n      {\n        "system": "http://terminology.hl7.org/CodeSystem/measure-improvement-notation",\n        "code": "increase"\n      }\n    ]\n  },\n  "group": [\n    {\n      "id": "groups",\n      "population": [\n        {\n          "id": "initial-population",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "initial-population"\n              }\n            ]\n          },\n          "count": 17\n        },\n        {\n          "id": "denominator",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "denominator"\n              }\n            ]\n          },\n          "count": 17\n        },\n        {\n          "id": "numerator",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "numerator"\n              }\n            ]\n          },\n          "count": 17\n        }\n      ],\n      "measureScore": {\n        "value": 1\n      }\n    },\n    {\n      "id": "males",\n      "population": [\n        {\n          "id": "initial-population",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "initial-population"\n              }\n            ]\n          },\n          "count": 17\n        },\n        {\n          "id": "denominator",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "denominator"\n              }\n            ]\n          },\n          "count": 17\n        },\n        {\n          "id": "numerator",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "numerator"\n              }\n            ]\n          },\n          "count": 7\n        }\n      ],\n      "measureScore": {\n        "value": 0.4117647058823529\n      },\n      "stratifier": [\n        {\n          "id": "by-age",\n          "stratum": [\n            {\n              "value": {\n                "text": "P0Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                }\n              ],\n              "measureScore": {\n                "value": 1\n              }\n            },\n            {\n              "value": {\n                "text": "P50Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 0\n                }\n              ],\n              "measureScore": {\n                "value": 0\n              }\n            },\n            {\n              "value": {\n                "text": "P15-49Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                }\n              ],\n              "measureScore": {\n                "value": 0.5\n              }\n            },\n            {\n              "value": {\n                "text": "P6-14Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 0\n                }\n              ],\n              "measureScore": {\n                "value": 0\n              }\n            },\n            {\n              "value": {\n                "text": "P1-5Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 11\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 11\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 5\n                }\n              ],\n              "measureScore": {\n                "value": 0.45454545454545453\n              }\n            }\n          ]\n        }\n      ]\n    },\n    {\n      "id": "females",\n      "population": [\n        {\n          "id": "initial-population",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "initial-population"\n              }\n            ]\n          },\n          "count": 17\n        },\n        {\n          "id": "denominator",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "denominator"\n              }\n            ]\n          },\n          "count": 17\n        },\n        {\n          "id": "numerator",\n          "code": {\n            "coding": [\n              {\n                "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                "code": "numerator"\n              }\n            ]\n          },\n          "count": 10\n        }\n      ],\n      "measureScore": {\n        "value": 0.5882352941176471\n      },\n      "stratifier": [\n        {\n          "id": "by-age",\n          "stratum": [\n            {\n              "value": {\n                "text": "P0Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 0\n                }\n              ],\n              "measureScore": {\n                "value": 0\n              }\n            },\n            {\n              "value": {\n                "text": "P50Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                }\n              ],\n              "measureScore": {\n                "value": 1\n              }\n            },\n            {\n              "value": {\n                "text": "P15-49Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 1\n                }\n              ],\n              "measureScore": {\n                "value": 0.5\n              }\n            },\n            {\n              "value": {\n                "text": "P6-14Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 2\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 2\n                }\n              ],\n              "measureScore": {\n                "value": 1\n              }\n            },\n            {\n              "value": {\n                "text": "P1-5Y"\n              },\n              "population": [\n                {\n                  "id": "initial-population",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "initial-population"\n                      }\n                    ]\n                  },\n                  "count": 11\n                },\n                {\n                  "id": "denominator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "denominator"\n                      }\n                    ]\n                  },\n                  "count": 11\n                },\n                {\n                  "id": "numerator",\n                  "code": {\n                    "coding": [\n                      {\n                        "system": "http://terminology.hl7.org/CodeSystem/measure-population",\n                        "code": "numerator"\n                      }\n                    ]\n                  },\n                  "count": 6\n                }\n              ],\n              "measureScore": {\n                "value": 0.5454545454545454\n              }\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n'})})]})}function u(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},1151:(n,e,o)=>{o.d(e,{Z:()=>s,a:()=>r});var t=o(7294);const i={},a=t.createContext(i);function r(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);